module.exports=[18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},29173,(e,t,r)=>{t.exports=e.x("@prisma/client",()=>require("@prisma/client"))},54799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},98043,e=>{"use strict";var t=e.i(29173);let r=e.g.prisma||new t.PrismaClient({log:["error"]});e.s(["prisma",0,r])},57196,e=>{"use strict";var t=e.i(47909),r=e.i(74017),a=e.i(96250),n=e.i(59756),s=e.i(61916),i=e.i(14444),o=e.i(37092),l=e.i(69741),d=e.i(16795),u=e.i(87718),E=e.i(95169),p=e.i(47587),c=e.i(66012),R=e.i(70101),T=e.i(26937),x=e.i(10372),g=e.i(93695);e.i(52474);var h=e.i(220),v=e.i(89171),I=e.i(79832),_=e.i(98043);let A={SUPER_ADMIN:["CREATE_USER","EDIT_USER","DELETE_USER","CREATE_EQUIPMENT","EDIT_EQUIPMENT","DELETE_EQUIPMENT","CREATE_BOOKING","EDIT_BOOKING","DELETE_BOOKING","CREATE_CUSTOMER","EDIT_CUSTOMER","DELETE_CUSTOMER","VIEW_REPORTS","MANAGE_INTEGRATIONS","MANAGE_SETTINGS"],ADMIN:["CREATE_USER","EDIT_USER","DELETE_USER","CREATE_EQUIPMENT","EDIT_EQUIPMENT","DELETE_EQUIPMENT","CREATE_BOOKING","EDIT_BOOKING","DELETE_BOOKING","CREATE_CUSTOMER","EDIT_CUSTOMER","DELETE_CUSTOMER","VIEW_REPORTS","MANAGE_INTEGRATIONS","MANAGE_SETTINGS"],MANAGER:["CREATE_EQUIPMENT","EDIT_EQUIPMENT","CREATE_BOOKING","EDIT_BOOKING","CREATE_CUSTOMER","EDIT_CUSTOMER","VIEW_REPORTS"],OPERATOR:["CREATE_BOOKING","EDIT_BOOKING","CREATE_CUSTOMER","VIEW_REPORTS"],VIEWER:["VIEW_REPORTS"]};async function O(e){try{var t;let r=await (0,I.auth)();if(!r)return v.NextResponse.json({error:"Não autorizado"},{status:401});if(t=r.user.role,!A[t]?.includes("VIEW_REPORTS")&&1)return v.NextResponse.json({error:"Sem permissão para visualizar logs"},{status:403});let{searchParams:a}=new URL(e.url),n=a.get("entity"),s=a.get("action"),i=a.get("userId"),o=a.get("entityId"),l=a.get("startDate"),d=a.get("endDate"),u=parseInt(a.get("page")||"1"),E=parseInt(a.get("limit")||"50"),p=(u-1)*E,c={tenantId:r.user.tenantId};n&&(c.entity=n),s&&(c.action=s),i&&(c.userId=i),o&&(c.entityId=o),(l||d)&&(c.createdAt={},l&&(c.createdAt.gte=new Date(l)),d&&(c.createdAt.lte=new Date(d)));let[R,T]=await Promise.all([_.prisma.activityLog.findMany({where:c,include:{user:{select:{id:!0,name:!0,email:!0,role:!0}}},orderBy:{createdAt:"desc"},take:E,skip:p}),_.prisma.activityLog.count({where:c})]);return v.NextResponse.json({logs:R,pagination:{page:u,limit:E,total:T,totalPages:Math.ceil(T/E)}})}catch(e){return console.error("Error fetching activity logs:",e),v.NextResponse.json({error:"Erro ao buscar logs de atividade"},{status:500})}}e.s(["GET",()=>O],64775);var N=e.i(64775);let C=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/activity-logs/route",pathname:"/api/activity-logs",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/activity-logs/route.ts",nextConfigOutput:"",userland:N}),{workAsyncStorage:m,workUnitAsyncStorage:y,serverHooks:f}=C;function S(){return(0,a.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:y})}async function w(e,t,a){C.isDev&&(0,n.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let v="/api/activity-logs/route";v=v.replace(/\/index$/,"")||"/";let I=await C.prepare(e,t,{srcPage:v,multiZoneDraftMode:!1});if(!I)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:_,params:A,nextConfig:O,parsedUrl:N,isDraftMode:m,prerenderManifest:y,routerServerContext:f,isOnDemandRevalidate:S,revalidateOnlyGenerated:w,resolvedPathname:M,clientReferenceManifest:P,serverActionsManifest:U}=I,D=(0,l.normalizeAppPath)(v),b=!!(y.dynamicRoutes[D]||y.routes[M]),j=async()=>((null==f?void 0:f.render404)?await f.render404(e,t,N,!1):t.end("This page could not be found"),null);if(b&&!m){let e=!!y.routes[M],t=y.dynamicRoutes[D];if(t&&!1===t.fallback&&!e){if(O.experimental.adapterPath)return await j();throw new g.NoFallbackError}}let G=null;!b||C.isDev||m||(G="/index"===(G=M)?"/":G);let k=!0===C.isDev||!b,q=b&&!k;U&&P&&(0,i.setReferenceManifestsSingleton)({page:v,clientReferenceManifest:P,serverActionsManifest:U,serverModuleMap:(0,o.createServerModuleMap)({serverActionsManifest:U})});let K=e.method||"GET",H=(0,s.getTracer)(),B=H.getActiveScopeSpan(),L={params:A,prerenderManifest:y,renderOpts:{experimental:{authInterrupts:!!O.experimental.authInterrupts},cacheComponents:!!O.cacheComponents,supportsDynamicResponse:k,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:O.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>C.onRequestError(e,t,a,f)},sharedContext:{buildId:_}},V=new d.NodeNextRequest(e),W=new d.NodeNextResponse(t),$=u.NextRequestAdapter.fromNodeNextRequest(V,(0,u.signalFromNodeResponse)(t));try{let i=async e=>C.handle($,L).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=H.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==E.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${K} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${K} ${v}`)}),o=!!(0,n.getRequestMeta)(e,"minimalMode"),l=async n=>{var s,l;let d=async({previousCacheEntry:r})=>{try{if(!o&&S&&w&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await i(n);e.fetchMetrics=L.renderOpts.fetchMetrics;let l=L.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let d=L.renderOpts.collectedTags;if(!b)return await (0,c.sendResponse)(V,W,s,L.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=(0,R.toNodeOutgoingHttpHeaders)(s.headers);d&&(t[x.NEXT_CACHE_TAGS_HEADER]=d),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==L.renderOpts.collectedRevalidate&&!(L.renderOpts.collectedRevalidate>=x.INFINITE_CACHE)&&L.renderOpts.collectedRevalidate,a=void 0===L.renderOpts.collectedExpire||L.renderOpts.collectedExpire>=x.INFINITE_CACHE?void 0:L.renderOpts.collectedExpire;return{value:{kind:h.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await C.onRequestError(e,t,{routerKind:"App Router",routePath:v,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:q,isOnDemandRevalidate:S})},f),t}},u=await C.handleResponse({req:e,nextConfig:O,cacheKey:G,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:y,isRoutePPREnabled:!1,isOnDemandRevalidate:S,revalidateOnlyGenerated:w,responseGenerator:d,waitUntil:a.waitUntil,isMinimalMode:o});if(!b)return null;if((null==u||null==(s=u.value)?void 0:s.kind)!==h.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(l=u.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",S?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),m&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let E=(0,R.fromNodeOutgoingHttpHeaders)(u.value.headers);return o&&b||E.delete(x.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||t.getHeader("Cache-Control")||E.get("Cache-Control")||E.set("Cache-Control",(0,T.getCacheControlHeader)(u.cacheControl)),await (0,c.sendResponse)(V,W,new Response(u.value.body,{headers:E,status:u.value.status||200})),null};B?await l(B):await H.withPropagatedContext(e.headers,()=>H.trace(E.BaseServerSpan.handleRequest,{spanName:`${K} ${v}`,kind:s.SpanKind.SERVER,attributes:{"http.method":K,"http.target":e.url}},l))}catch(t){if(t instanceof g.NoFallbackError||await C.onRequestError(e,t,{routerKind:"App Router",routePath:D,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:q,isOnDemandRevalidate:S})}),b)throw t;return await (0,c.sendResponse)(V,W,new Response(null,{status:500})),null}}e.s(["handler",()=>w,"patchFetch",()=>S,"routeModule",()=>C,"serverHooks",()=>f,"workAsyncStorage",()=>m,"workUnitAsyncStorage",()=>y],57196)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__2f76a303._.js.map